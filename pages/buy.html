{% extends "base.html" %}
{% block title %}Buy{% endblock %}
{% block content %}
<div class="container mt-5">
  <h1>Buy</h1>

  <form method="post" action="/buy_confirmation">
    <div class="secondary p-4">
      <table class="table table-striped border-dark align-middle">
        <thead>
          <tr>
            <th style="width:70px;">Select</th>
            <th>Name</th>
            <th>Ticker Symbol</th>
            <th>Price</th>
            <th>Volume</th>
          </tr>
        </thead>
        <tbody>
          {% for s in stocks %}
          <tr>
            <td class="text-center">
              <input class="form-check-input" type="radio" name="stock_id" value="{{ s.id }}" required>
            </td>
            <td>{{ s.name }}</td>
            <td>{{ s.ticker }}</td>
            <td>${{ '%.2f'|format(s.price) }}</td>
            <td>{{ (format_num(s.volume)) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      <nav class="mt-4">
      <ul class="pagination justify-content-center custom-pagination">
          {% if stocks.has_prev %}
              <li class="page-item">
              <a class="page-link" href="{{ url_for('buy', page_num=stocks.page - 1) }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
              </a>
              </li>
          {% else %}
              <li class="page-item disabled">
              <a class="page-link" href="{{ url_for('buy', page_num=stocks.page - 1) }}" aria-label="Previous">
                  <span aria-hidden="true">&laquo;</span>
              </a>
              </li>
          {% endif %}

          {% for page in stocks.iter_pages() %}
              {% if page == current_page %}
                  <li class="page-item active"><a class="page-link" href="{{ url_for('buy', page_num=page) }}">{{ page }}</a></li>
              {% else %}
                  <li class="page-item"><a class="page-link" href="{{ url_for('buy', page_num=page) }}">{{ page }}</a></li>
              {% endif %}
          {% endfor %}

          {% if stocks.has_next %}
              <li class="page-item">
              <a class="page-link" href="{{ url_for('buy', page_num=stocks.page + 1) }}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
              </a>
              </li>
          {% else %}
              <li class="page-item disabled">
              <a class="page-link" href="{{ url_for('buy', page_num=stocks.page + 1) }}" aria-label="Next">
                  <span aria-hidden="true">&raquo;</span>
              </a>
              </li>
          {% endif %}
      </ul>
      </nav>

      
    </div>

    <div class="row g-2 align-items-end">
      <div class="col-auto">
        <label for="qty" class="form-label"># of shares:</label>
        <input id="qty" name="quantity" type="number" class="form-control" min="1" value="1" required>
      </div>
      <div class="col-auto">
        <button type="submit" class="btn btn-primary mt-4">Buy</button>
      </div>
        {% if current_user.is_authenticated %}
            <p>User {{ current_user.fname }}'s balance: ${{ "%.2f"|format(current_user.balance) }}</p>
        {% endif %}
      </div>
    </div>
  </form>
</div>
{% endblock %}